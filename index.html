<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Celestial Harmonograph</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/addons/p5.sound.min.js"></script>
  <script src="js/Settings.js"></script>
  <script src="js/Planet.js"></script>
  <script src="js/Comet.js"></script>
  <script src="js/AudioAnalyzer.js"></script>
  <script src="js/HarmonographRenderer.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="controls">
    <div id="title">THE CELESTIAL HARMONOGRAPH</div>
    <div id="subtitle">An Audio-Reactive Generative Art Experience</div>

    <button class="control-btn" id="micBtn">ğŸ¤ Use Microphone</button>

    <div id="orDivider">â€” or â€”</div>

    <button class="control-btn" id="uploadBtn">ğŸ“ Upload Audio File</button>
    <input type="file" id="fileInput" accept="audio/*">

    <div style="margin-top: 30px; font-size: 12px; opacity: 0.5;">
      Supports MP3, WAV, OGG, and other audio formats
    </div>
  </div>

  <div id="songInfo"></div>

  <button id="panelToggle">âš™ Settings</button>

  <div id="planetPanel">
    <h3>ğŸµ Audio Reactivity</h3>

    <!-- Beat Detection -->
    <div class="slider-container">
      <label>Beat Sensitivity: <span id="beatSensitivityValue">0.50</span></label>
      <input type="range" id="beatSensitivitySlider" min="0" max="100" value="50">
      <div class="slider-hint">How easily beats are detected</div>
    </div>

    <div class="slider-container">
      <label>Pulse Strength: <span id="pulseStrengthValue">8</span>%</label>
      <input type="range" id="pulseStrengthSlider" min="0" max="20" value="8">
      <div class="slider-hint">Screen "thump" on kick drums</div>
    </div>

    <div class="slider-container">
      <label>Pitch â†’ Radius: <span id="pitchSensitivityValue">1.00</span></label>
      <input type="range" id="pitchSensitivitySlider" min="0" max="100" value="100">
      <div class="slider-hint">Low pitch = expand, High pitch = contract</div>
    </div>

    <h3>ğŸ¨ Drawing Settings</h3>

    <!-- Trail Persistence Toggle -->
    <div class="toggle-container highlight-toggle">
      <label>
        <input type="checkbox" id="persistentTrailsToggle" checked>
        Persistent Trails (accumulate)
      </label>
      <div class="slider-hint">Off = lines fade quickly (live mode)</div>
    </div>

    <!-- Drawing Mode -->
    <div class="section-label">Drawing Mode</div>
    <div class="mode-buttons">
      <button class="mode-btn active" data-mode="lines">Lines</button>
      <button class="mode-btn" data-mode="midpoints">Midpoints</button>
      <button class="mode-btn" data-mode="both">Both</button>
    </div>

    <!-- Split Screen Toggle -->
    <div class="toggle-container">
      <label>
        <input type="checkbox" id="splitScreenToggle">
        Split Screen Mode
      </label>
    </div>

    <!-- BPM Sync -->
    <div class="section-label" style="margin-top: 15px;">BPM Override</div>
    <div class="toggle-container">
      <label>
        <input type="checkbox" id="bpmSyncToggle">
        Manual BPM Sync
      </label>
    </div>
    <div class="slider-container">
      <label>BPM: <span id="bpmValue">120</span></label>
      <input type="range" id="bpmSlider" min="60" max="200" value="120">
    </div>

    <h3>âœï¸ Line Settings</h3>

    <div class="slider-container">
      <label>Line Opacity: <span id="opacityValue">30</span>%</label>
      <input type="range" id="opacitySlider" min="5" max="100" value="30">
    </div>

    <div class="slider-container">
      <label>Line Weight: <span id="weightValue">0.8</span></label>
      <input type="range" id="weightSlider" min="1" max="30" value="8">
    </div>

    <div class="slider-container">
      <label>Draw Interval: <span id="intervalValue">1</span></label>
      <input type="range" id="intervalSlider" min="1" max="30" value="1">
      <div class="slider-hint">Frames between draws</div>
    </div>

    <div class="slider-container">
      <label>Electricity: <span id="noiseValue">60</span>%</label>
      <input type="range" id="noiseSlider" min="0" max="100" value="60">
      <div class="slider-hint">Jagged lines when loud</div>
    </div>

    <div class="slider-container">
      <label>Comets: <span id="cometValue">25</span></label>
      <input type="range" id="cometSlider" min="0" max="100" value="25">
    </div>

    <!-- Planet Pairs Section -->
    <h3 id="pairsHeaderLeft">ğŸª Planet Pairs</h3>
    <div id="pairsContainerLeft">
      <div class="pair-option">
        <input type="checkbox" id="pairAB" checked>
        <span class="color-dot" style="background: hsl(200, 80%, 60%);"></span>
        <label for="pairAB">A â†” B (7:11) <small>pitch-reactive</small></label>
      </div>
      <div class="pair-option">
        <input type="checkbox" id="pairAC">
        <span class="color-dot" style="background: hsl(320, 80%, 60%);"></span>
        <label for="pairAC">A â†” C (7:13)</label>
      </div>
      <div class="pair-option">
        <input type="checkbox" id="pairBC">
        <span class="color-dot" style="background: hsl(60, 80%, 60%);"></span>
        <label for="pairBC">B â†” C (11:13)</label>
      </div>
      <div class="pair-option">
        <input type="checkbox" id="pairAD">
        <span class="color-dot" style="background: hsl(140, 80%, 60%);"></span>
        <label for="pairAD">A â†” D (7:17)</label>
      </div>
      <div class="pair-option">
        <input type="checkbox" id="pairBD">
        <span class="color-dot" style="background: hsl(280, 80%, 60%);"></span>
        <label for="pairBD">B â†” D (11:17)</label>
      </div>
      <div class="pair-option">
        <input type="checkbox" id="pairCD">
        <span class="color-dot" style="background: hsl(20, 80%, 60%);"></span>
        <label for="pairCD">C â†” D (13:17)</label>
      </div>
    </div>

    <!-- Right Side Pairs (shown in split screen mode) -->
    <div id="rightPairsSection" style="display: none;">
      <h3>Right Side Pairs</h3>
      <div id="pairsContainerRight">
        <div class="pair-option">
          <input type="checkbox" id="pairAB_R">
          <span class="color-dot" style="background: hsl(200, 80%, 60%);"></span>
          <label for="pairAB_R">A â†” B (7:11)</label>
        </div>
        <div class="pair-option">
          <input type="checkbox" id="pairAC_R" checked>
          <span class="color-dot" style="background: hsl(320, 80%, 60%);"></span>
          <label for="pairAC_R">A â†” C (7:13)</label>
        </div>
        <div class="pair-option">
          <input type="checkbox" id="pairBC_R">
          <span class="color-dot" style="background: hsl(60, 80%, 60%);"></span>
          <label for="pairBC_R">B â†” C (11:13)</label>
        </div>
        <div class="pair-option">
          <input type="checkbox" id="pairAD_R">
          <span class="color-dot" style="background: hsl(140, 80%, 60%);"></span>
          <label for="pairAD_R">A â†” D (7:17)</label>
        </div>
        <div class="pair-option">
          <input type="checkbox" id="pairBD_R">
          <span class="color-dot" style="background: hsl(280, 80%, 60%);"></span>
          <label for="pairBD_R">B â†” D (11:17)</label>
        </div>
        <div class="pair-option">
          <input type="checkbox" id="pairCD_R">
          <span class="color-dot" style="background: hsl(20, 80%, 60%);"></span>
          <label for="pairCD_R">C â†” D (13:17)</label>
        </div>
      </div>
    </div>
  </div>

  <div id="playbackControls">
    <button class="playback-btn" id="playPauseBtn">â¸ Pause</button>
    <button class="playback-btn" id="restartBtn">â†º Restart</button>
    <button class="playback-btn" id="resetDrawingBtn">ğŸ—‘ Clear</button>
  </div>

  <div id="progressBar"></div>

  <div id="info">R: Reset | S: Save | Space: Play/Pause | P: Settings</div>

  <script src="js/main.js"></script>
</body>
</html>
